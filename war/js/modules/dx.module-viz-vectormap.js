/*! 
* DevExpress Visualization VectorMap (part of ChartJS)
* Version: 13.2.5
* Build date: Dec 3, 2013
*
* Copyright (c) 2012 - 2013 Developer Express Inc. ALL RIGHTS RESERVED
* EULA: http://chartjs.devexpress.com/EULA
*/
"use strict";if(!DevExpress.MOD_VIZ_VECTORMAP){if(!window.DevExpress)throw Error("Required module is not referenced: core");if(!DevExpress.MOD_VIZ_CORE)throw Error("Required module is not referenced: viz-core");(function(n,t,i){function f(n,t){n.data("index",t)}function a(n){return n.data("index")}function wr(){var n=this._projection.getZoom();this._projection.setCenter(null).setZoom(null),this._applyTransform(n!==this._projection.getZoom())}function br(n,t){this._projection.moveCenter(n,t),this._applyTransform()}function kr(n){this._projection.setZoom(n),this._applyTransform(!0)}function dr(n){n.data=a(n.$target),this._controlBar.processStart(n)}function gr(n){n.data=a(n.$target),this._controlBar.processMove(n)}function nu(n){n.data=a(n.$target),this._controlBar.processEnd(n)}function tu(n){this._controlBar.processWheel(n)}function iu(n){var t=a(n.$target);switch(n.category){case"areas":this._setAreaHover(this._areasInfo[t],!0);break;case"markers":this._setMarkerHover(this._markersInfo[t],!0)}}function ru(n){var t=a(n.$target);switch(n.category){case"areas":this._setAreaHover(this._areasInfo[t],!1);break;case"markers":this._setMarkerHover(this._markersInfo[t],!1)}}function uu(n){var t=this,u=a(n.$target),i,r;switch(n.category){case"areas":i=t._areaClickCallback,r=t._areasInfo[u].proxy;break;case"markers":i=t._markerClickCallback,r=t._markersInfo[u].proxy}i&&i.call(r,r)}function fu(n){var i=a(n.$target),t;switch(n.category){case"areas":t=this._areasInfo[i];break;case"markers":t=this._markersInfo[i]}return this._tooltip.check(t.proxy)}function eu(){this._tooltip.show()}function ou(n){var t=cr(this._renderer);this._tooltip.move({x:n.x-t.left,y:n.y-t.top})}function su(){this._tooltip.hide()}function d(n,t,r){var f,e=0,o={};for(f in r)t[f]!==i&&(++e,o[r[f]]=t[f]);return e?u({},n,o):n}function wu(n,t){var i=n&&n.start&&n.end?n:kt[ut(n).toLowerCase()]||kt["default"];i=t>0?bu(i.start,i.end,e(t)):[],this.getColor=function(n){return i[n]||null}}function bu(n,t,i){var f=new ci(n),e=new ci(t);if(i===1)return[f.blend(e,.5).toHex()];var u=[],s=1/(i-1),r,o=i;for(u.push(0),r=1;r<o-1;++r)u.push(s*r);for(u.push(1),r=0;r<o;++r)u[r]=f.blend(e,u[r]).toHex();return u}function rf(){var u=window,n=u.navigator.pointerEnabled,t=u.navigator.msPointerEnabled,i="ontouchstart"in u;r.start=y(n?"pointerdown":t?"MSPointerDown":i?"touchstart mousedown":"mousedown",h),r.move=y(n?"pointermove":t?"MSPointerMove":i?"touchmove mousemove":"mousemove",h),r.end=y(n?"pointerup":t?"MSPointerUp":i?"touchend mouseup":"mouseup",h),r.over=y(n?"pointerover":t?"MSPointerOver":"mouseover",h),r.out=y(n?"pointerout":t?"MSPointerOut":"mouseout",h),r.wheel=y("mousewheel DOMMouseScroll",h),n?(g="pointer",tt={"touch-action":"none"},it={"touch-action":""},v=function(n){return n.originalEvent.pointerType!=="mouse"}):t?(g="MSPointer",tt={"-ms-touch-action":"none"},it={"-ms-touch-action":""},v=function(n){return n.originalEvent.pointerType!==4}):i?(g="touch",tt={"-webkit-user-select":"none"},it={"-webkit-user-select":""},v=function(){return!0}):(g="mouse",tt={},it={},v=function(){return!1})}function rt(n){var t=n.originalEvent,i=t.changedTouches?t.changedTouches[0]:{};return{x:n.pageX||t.pageX||i.pageX,y:n.pageY||t.pageY||i.pageY}}function nt(n){delete n._owner,n.update=function(){},n.finish=function(){}}function ti(n,t){this._owner=n,this._x=t.x,this._y=t.y}function ii(n,t){this._owner=n,this._command=t.data}function ri(n,t){function u(){n._move(i,r),f=ft(u,e)}this._command=t.data;var f=null,e=100,i=0,r=0;switch(this._command){case lt:r=-10;break;case at:i=10;break;case vt:r=10;break;case yt:i=-10}this._stop=function(){return c(f),this._stop=n=u=null,this},t=null,u()}function ui(n,t){function i(){n._adjustZoom(n._zoomFactor+f),r=ft(i,u)}this._owner=n,this._command=t.data;var r=null,u=150,f=this._command===pt?.5:-.5;this._stop=function(){return c(r),this._stop=n=i=null,this},t=null,i()}function fi(n,t){this._owner=n,this._pos=t.y}function rr(n,t,r){var u=this,f,e;u.selected=function(u){var f=!!t.selected;return u!==i?(!!u!==f&&r.setSelectionCallback.call(n,t,!f),this):f},u.type=r.type,f=t.attributes,u.attribute=function(n){return f[n]},e=t.options,u.option=function(n){return e[n]},u._dispose=function(){n=t=f=e=null}}var kt,s,nr,tr,ir;n.viz.map={};var e=window.Number,ut=window.String,pf=window.isFinite,ft=window.setTimeout,c=window.clearTimeout,p=Math.round,et=Math.abs,ur=Math.max,ei=Math.min,oi=Math.pow,si=Math.log,fr=Math.exp,er=Math.tan,or=Math.atan,ot=n.utils.isArray,l=n.utils.isFunction,sr=n.utils.isString,hi=n.utils.windowResizeCallbacks,hr=n.utils.createResizeHandler,cr=n.utils.getRootOffset,w=n.viz.renderers.buildPath,ci=n.Color,lr=t.ajax,u=t.extend,ar=Math.LN2,li="command-reset",lt="command-move-up",at="command-move-right",vt="command-move-down",yt="command-move-left",pt="command-zoom-in",ai="command-zoom-out",vi="command-zoom-drag",vr=800,yr=400,wt=1,bt=32,yi=300,pi=300,pr=400,wi=300,b="none",o="single",k="multiple",st=1,ht=2;n.viz.map.Map=n.ui.Component.inherit({_rendererType:n.viz.renderers.Renderer,_init:function(){var n=this;n.callBase(),n._renderer=new n._rendererType,n._renderer.recreateCanvas(1,1),n._renderer.draw(n._element().get(0)),n._themeManager=new n._themeManagerType,n._projection=new n._projectionType,n._tracker=new n._trackerType,n._root=n._renderer.getRoot(),n._root.applySettings({"class":"dxm",stroke:"none",strokeWidth:0,fill:"none",align:"center",cursor:"default",style:{overflow:"hidden"}}),n._background=n._renderer.createSimplePath({"class":"dxm-background"}),n._tracker.attachRoot(n._root),n._tracker.setCallbacks(n,{start:dr,move:gr,end:nu,wheel:tu,"hover-on":iu,"hover-off":ru,click:uu,"tooltip-check":fu,"tooltip-show":eu,"tooltip-move":ou,"tooltip-hide":su}),n._initAreas(),n._initMarkers(),n._controlBar=new n._controlBarType({container:n._root,renderer:n._renderer,context:n,resetCallback:wr,moveCallback:br,zoomCallback:kr}),n._tooltip=new n._tooltipType({container:n._root,renderer:n._renderer}),n._legend=new n._legendType({container:n._root,renderer:n._renderer,themeManager:n._themeManager}),n._initResizing()},_initAreas:function(){var n=this;n._areasGroup=n._renderer.createGroup({"class":"dxm-areas"}),n._areasCancelLock=0,n._tracker.attachGroup("areas",n._areasGroup)},_initMarkers:function(){var n=this,t=u({},n.option("marker"));n._markersGroup=n._renderer.createGroup({"class":"dxm-markers"}),n._markerShapesGroup=n._renderer.createGroup(),n._markerTextsGroup=n._renderer.createGroup({"class":"dxm-marker-texts"}),n._markerCoversGroup=n._renderer.createGroup({stroke:"none",strokeWidth:0,fill:"#000000",opacity:.0001}),n._markerShadowFilter=n._renderer.createFilter("shadow").applySettings({id:"shadow-filter",x:"-40%",y:"-40%",width:"180%",height:"200%",color:"#000000",opacity:.2,dx:0,dy:1,blur:1}).append(),n._markersCancelLock=0,n._tracker.attachGroup("markers",n._markersGroup)},_initResizing:function(){var n=this;n._resizeHandler=hr(function(){n._resize()}),n._resizeHandler.dispose=function(){return n=null,this},hi.add(n._resizeHandler)},_dispose:function(){var n=this;n.callBase(),delete n._root,delete n._background,n._themeManager.dispose()&&delete n._themeManager,n._tracker.detachRoot(),n._disposeAreas(),n._disposeMarkers(),n._controlBar.dispose()&&delete n._controlBar,n._tooltip.dispose()&&delete n._tooltip,n._legend.dispose()&&delete n._legend,n._renderer.dispose(),delete n._renderer,delete n._projection,n._tracker.dispose()&&delete n._tracker,delete n._readyCallback,n._disposeResizing(),n._remoteDataCache=null},_disposeAreas:function(){var n=this;n._areasGroup=n._areasInfo=n._areasDataItems=null,n._tracker.detachGroup("areas")},_disposeMarkers:function(){var n=this;n._markersGroup.clear(),n._markerShadowFilter.dispose(),n._markersGroup=n._markerShapesGroup=n._markerTextsGroup=n._markerCoversGroup=n._markerShadowFilter=n._markersDataItems=null,n._tracker.detachGroup("markers")},_disposeResizing:function(){var n=this;hi.remove(n._resizeHandler),n._resizeHandler.stop().dispose()&&delete n._resizeHandler},_adjustSize:function(){var n=this,r=n.option("size")||{},t=r.width>=0?e(r.width):n._element().width(),i=r.height>=0?e(r.height):n._element().height(),u;return t===0&&e(r.width)!==0&&(t=vr),i===0&&e(r.height)!==0&&(i=yr),u=n._width!==t||n._height!==i,u&&(n._renderer.resize(t,i),n._projection.setSize(t,i),n._applyTransform(),n._tooltip.setSize(t,i),n._legend.setSize(t,i),n._background.applySettings({d:w([0,0,t,0,t,i,0,i])}),n._width=t,n._height=i),u},_clean:function(){var n=this;n._themeManager.reset(),n._background.detach(),n._cleanAreas(),n._cleanMarkers(),n._controlBar.clean(),n._legend.clean(),n._tooltip.clean(),n._tracker.clean()},_render:function(){var n=this;n._projection.setBounds(n.option("bounds")).setZoom(n.option("zoomFactor")).setCenter(n.option("center")),n._adjustSize(),n._themeManager.setTheme(n.option("theme")),n._tooltip.setOptions(n._themeManager.getTooltipSettings(n.option("tooltip"))),n._legend.setOptions(n._themeManager.getLegendSettings(n.option("legend"))),n._tracker.setOptions(n._getTrackerSettings()),n._controlBar.setZoom(n._projection.getZoom()).setOptions(n._themeManager.getControlBarSettings(n.option("controlBar"))),l(n._readyCallback=n.option("ready"))||(n._readyCallback=null),n._applyTransform(),n._background.applySettings(n._themeManager.getBackgroundSettings(n.option("background"))),n._background.append(n._root),n._renderAreas(),n._renderMarkers(),n._controlBar.render(),n._legend.render(),n._tooltip.render(),n._tracker.render(),n._contentReady=!0,n._raiseReady()},_getTrackerSettings:function(){var n=this.option("interaction"),t={};return n===i||n?(n=n||{},t.enabled=!0,t.touchEnabled=n.touchEnabled!==i?!!n.touchEnabled:!0,t.wheelEnabled=n.wheelEnabled!==i?!!n.wheelEnabled:!0,t.tooltipEnabled=this._tooltip.enabled()):t.enabled=!1,t},_optionChanged:function(n,t){switch(n){case"zoomFactor":this._updateZoomFactor(t);break;case"center":this._updateCenter(t);break;default:this._invalidate()}},_updateZoomFactor:function(n){var t=this,i=t._projection.getZoom();t._projection.setZoom(n),i!==t._projection.getZoom()&&(t._controlBar.setZoom(t._projection.getZoom()),t._applyTransform(!0))},_updateCenter:function(n){var t=this;t._projection.setCenter(n),t._applyTransform()},_resize:function(){var n=this;n._adjustSize()&&(n._applyTransform(),n._parseAreas(),n._redrawAreas(),n._parseMarkers(),n._redrawMarkers())},_raiseReady:function(){var n=this;n._areasReady&&n._markersReady&&n._contentReady&&(n._areasReady=n._markersReady=n._contentReady=null,n._readyCallback&&n._readyCallback())},_loadData:function(n,t){if(ot(n))t(n);else if(sr(n)){var i=this._remoteDataCache=this._remoteDataCache||{};i[n]?t(i[n]):lr({url:n,dataType:"json",type:"GET",success:function(r){i[n]=ot(r)?r:[],t(i[n])},error:function(n,i,r){t([],r)}})}else t([])},_cleanAreas:function(){var n=this,t,i,r;if(n._areaCustomizeCallback=n._areaClickCallback=n._areaSelectionChangedCallback=n._selectedAreas=null,n._areasGroup.detach(),n._areasGroup.clear(),t=n._areasInfo,t){for(i=0,r=t.length;i<r;++i)t[i].proxy._dispose();n._areasInfo=null}else++n._areasCancelLock},_renderAreas:function(){var n=this,t=n.option("areaSettings")||{},r=n.option("mapData"),i;n._themeManager.initCommonAreaSettings(t),n._areaCustomizeCallback=l(t.customize)?t.customize:null,n._areaClickCallback=l(t.click)?t.click:null,n._areaSelectionChangedCallback=l(t.selectionChanged)?t.selectionChanged:null,n._areaHoverEnabled="hoverEnabled"in t?!!t.hoverEnabled:!0,i=ut(t.selectionMode).toLowerCase(),n._areaSelectionMode=i===b||i===o||i===k?i:o,n._selectedAreas=n._areaSelectionMode===k?{}:null,n._areasGroup.append(n._root),n._loadData(r,function(t){n._areasDataItems=t,n._areasCancelLock===0?n._createAreas():--n._areasCancelLock,n=null})},_parseAreas:function(){for(var t=this._areasInfo,i=this._areasDataItems,r=this._projection,n=0,u=i.length;n<u;++n)(t[n]=t[n]||{}).coordinates=r.parseAreaData(i[n].coordinates)},_createAreas:function(){var n=this,h=n._areasInfo=[];n._parseAreas();var c=n._areasGroup,y=n._renderer,l=n._themeManager,p=n._projection,w=n._areasDataItems,a=n._areaCustomizeCallback,t,r,i=0,u=h.length,s=[],e,v;for(c.applySettings(l.getCommonAreaSettings().common);i<u;++i)t=h[i],r=w[i],e=null,t.attributes=r.attributes=r.attributes||{},t.options=(a?a.call(r,r):null)||{},v=p.projectArea(t.coordinates),t.styles=l.getAreaSettings(t.options),t.element=e=y.createSimplePath({d:v}),e.applySettings(t.styles.normal),t.index=i,f(e.$element,i),t.options.isSelected&&s.push(t),t.proxy=new rr(n,t,{type:"area",setSelectionCallback:n._setAreaSelection}),e.append(c);for(u=n._areaSelectionMode!==b?s.length:0,i=u>0&&n._areaSelectionMode===o?u-1:0;i<u;++i)n._setAreaSelection(s[i],!0,st);n._areasReady=!0,n._raiseReady()},_redrawAreas:function(){for(var i=this._areasInfo,r=this._projection,n,t=0,u=i.length;t<u;++t)n=i[t],n.element.applySettings({d:r.projectArea(n.coordinates)})},_cleanMarkers:function(){var n=this,t,i,r;if(n._markerCustomizeCallback=n._markerClickCallback=n._markerSelectionChangedCallback=n._selectedMarkers=null,n._markersGroup.detach(),n._markerShapesGroup.detach(),n._markerTextsGroup.detach(),n._markerCoversGroup.detach(),n._markerShapesGroup.clear(),n._markerTextsGroup.clear(),n._markerCoversGroup.clear(),t=n._markersInfo,t){for(i=0,r=t.length;i<r;++i)t[i].proxy._dispose();n._markersInfo=null}else++n._markersCancelLock},_renderMarkers:function(){var n=this,t=n.option("markerSettings")||{},r=n.option("markers"),i;n._themeManager.initCommonMarkerSettings(t),n._markerCustomizeCallback=l(t.customize)?t.customize:null,n._markerClickCallback=l(t.click)?t.click:null,n._markerSelectionChangedCallback=l(t.selectionChanged)?t.selectionChanged:null,n._markerHoverEnabled="hoverEnabled"in t?!!t.hoverEnabled:!0,i=ut(t.selectionMode).toLowerCase(),n._markerSelectionMode=i===b||i===o||i===k?i:o,n._selectedMarkers=n._markerSelectionMode===k?{}:null,n._markersGroup.append(n._root),n._loadData(r,function(t){n._markersDataItems=t,n._markersCancelLock===0?n._createMarkers():--n._markersCancelLock,n=null})},_parseMarkers:function(){for(var t=this._markersInfo,i=this._markersDataItems,r=this._projection,n=0,u=i.length;n<u;++n)(t[n]=t[n]||{}).coordinates=r.parsePointData(i[n].coordinates)},_createMarkers:function(){var t=this,w=t._markersInfo=[];t._parseMarkers();var c=t._markersGroup,l=t._markerShapesGroup,a=t._markerTextsGroup,k=t._markerCoversGroup,v=t._renderer,e=t._themeManager,g=t._projection,nt=t._markersDataItems,d=t._markerCustomizeCallback,n,r,i=0,u=w.length,y=[],s,p,h;for(l.applySettings(e.getCommonMarkerSettings().common),a.applySettings(e.getCommonMarkerSettings().text),e.getCommonMarkerSettings().normal.filter=t._markerShadowFilter.ref;i<u;++i)n=w[i],r=nt[i],n.attributes=r.attributes=r.attributes||{},n.options=(d?d.call(r,r):null)||{},n.styles=e.getMarkerSettings(n.options),s=p=h=null,n.location=g.projectPoint(n.coordinates),n.index=i,s=v.createCircle(n.location.x,n.location.y,n.styles.size,n.styles.normal).append(l),f(s.$element,i),n.options.text&&(p=v.createText(n.options.text,n.location.x,n.location.y).append(a),h=v.createRect().append(k),f(h.$element,i)),n.shape=s,n.text=p,n.cover=h,n.options.isSelected&&y.push(n),n.proxy=new rr(t,n,{type:"marker",setSelectionCallback:t._setMarkerSelection});for(l.append(c),a.append(c),k.append(c),t._arrangeMarkers(),u=t._markerSelectionMode!==b?y.length:0,i=u>0&&t._markerSelectionMode===o?u-1:0;i<u;++i)t._setMarkerSelection(y[i],!0,st);t._markersReady=!0,t._raiseReady()},_arrangeMarkers:function(){for(var r=this,o=r._markersInfo,s=o.length,n,h=[],u,i,f,e,t=0;t<s;++t)n=o[t],u=null,n.text&&(i=n.text.getBBox(),f=n.location.x,e=n.location.y,n.textOffsetX=p(f-i.x+n.styles.size)+2,n.textOffsetY=p(e-i.y-i.height/2)-1,n.trackerOffsetX=n.textOffsetX+i.x-f-1,n.trackerOffsetY=n.textOffsetY+i.y-e-1,n.trackerWidth=i.width+2,n.trackerHeight=i.height+2,u={text:{x:f+n.textOffsetX,y:e+n.textOffsetY},cover:{x:f+n.trackerOffsetX,y:e+n.trackerOffsetY,width:n.trackerWidth,height:n.trackerHeight}}),h.push(u);for(r._markerTextsGroup.detach(),r._markerCoversGroup.detach(),t=0;t<s;++t)n=o[t],n.text&&(u=h[t],n.text.applySettings(u.text),n.cover.applySettings(u.cover));r._markerTextsGroup.append(r._markersGroup),r._markerCoversGroup.append(r._markersGroup)},_redrawMarkers:function(){for(var u=this._markersInfo,f=this._projection,n,r=0,e=u.length,t,i;r<e;++r)n=u[r],n.location=f.projectPoint(n.coordinates),t=n.location.x,i=n.location.y,n.shape.applySettings({cx:t,cy:i}),n.extra&&n.extra.applySettings({cx:t,cy:i}),n.options.text&&(n.text.applySettings({x:t+n.textOffsetX,y:i+n.textOffsetY}),n.cover.applySettings({x:t+n.trackerOffsetX,y:i+n.trackerOffsetY}))},_applyTransform:function(n){var t=this,i=t._projection.getTransform();t._areasGroup.applySettings(i),t._markersGroup.applySettings(i),n&&(t._redrawAreas(),t._redrawMarkers())},_setAreaHover:function(n,t){this._areaHoverEnabled&&(n.hovered=!!t,n.selected||(n.element.applySettings(n.styles[t?"hovered":"normal"]),t?n.element.toForeground():n.element.toBackground()))},_setMarkerHover:function(n,t){if(this._markerHoverEnabled){n.hovered=!!t;var i=n.extra;n.selected||(n.hovered?(i||(i=n.extra=this._renderer.createCircle(n.location.x,n.location.y,n.styles.extraSize,n.styles.extra),f(i.$element,n.index)),n.shape.applySettings(n.styles.hovered),i.insertBefore(n.shape)):(n.shape.applySettings(n.styles.normal),i.detach(),i.dispose(),n.extra=null))}},_setAreaSelection:function(n,t,i){var r=this;r._areaSelectionMode!==b&&(n.selected=!!t,n.element.applySettings(n.styles[t?"selected":n.hovered?"hovered":"normal"]),n.selected?n.hovered||n.element.toForeground():n.hovered||n.element.toBackground(),i&st||!r._areaSelectionChangedCallback||r._areaSelectionChangedCallback.call(n.proxy,n.proxy),i&ht||(r._areaSelectionMode===o?(n.selected&&r._selectedAreas&&r._setAreaSelection(r._selectedAreas,!1,i|ht),r._selectedAreas=n.selected?n:null):n.selected?r._selectedAreas[n.index]=n:delete r._selectedAreas[n.index]))},_setMarkerSelection:function(n,t,i){var r=this,u;r._markerSelectionMode!==b&&(n.selected=!!t,u=n.extra,n.selected?(u||(u=n.extra=r._renderer.createCircle(n.location.x,n.location.y,n.styles.extraSize,n.styles.extra),f(u.$element,n.index)),n.shape.applySettings(n.styles.selected),u.insertBefore(n.shape)):n.hovered?n.shape.applySettings(n.styles.hovered):(n.shape.applySettings(n.styles.normal),u.detach(),u.dispose(),n.extra=null),i&st||!r._markerSelectionChangedCallback||r._markerSelectionChangedCallback.call(n.proxy,n.proxy),i&ht||(r._markerSelectionMode===o?(n.selected&&r._selectedMarkers&&r._setMarkerSelection(r._selectedMarkers,!1,i|ht),r._selectedMarkers=n.selected?n:null):n.selected?r._selectedMarkers[n.index]=n:delete r._selectedMarkers[n.index]))},render:function(n){return n==="resize"?this._resize():this._refresh(),this},getAreas:function(){for(var t=this._areasInfo,n=0,r=t.length,i=[];n<r;++n)i.push(t[n].proxy);return i},getMarkers:function(){for(var t=this._markersInfo,n=0,r=t.length,i=[];n<r;++n)i.push(t[n].proxy);return i},clearAreaSelection:function(){var n=this,t=n._selectedAreas,i;if(n._areaSelectionMode===o)t&&n._setAreaSelection(t,!1);else if(n._areaSelectionMode===k)for(i in t)n._setAreaSelection(t[i],!1);return n},clearMarkerSelection:function(){var n=this,t=n._selectedMarkers,i;if(n._markerSelectionMode===o)t&&n._setMarkerSelection(t,!1);else if(n._markerSelectionMode===k)for(i in t)n._setMarkerSelection(t[i],!1);return n},clearSelection:function(){return this.clearAreaSelection().clearMarkerSelection()}});var hu=n.Class.inherit({dispose:function(){var n=this;return n._inner&&n._inner.dispose(),n._inner=n._theme=null,n},setTheme:function(t){var i=this;return i._inner&&i._tag===t||(i._tag=t,i._inner&&i._inner.dispose(),i._inner=new n.viz.core.BaseThemeManager(t,"map"),i._theme=i._inner.theme,i._inner.initializeFont(i._theme.marker.font),i._inner.initializeFont(i._theme.tooltip.font),i._inner.initializeFont(i._theme.legend.font)),i},reset:function(){return this._commonAreaSettings=this._commonMarkerSettings=this._palette=null,this},getBackgroundSettings:function(n){var t=this._theme.background,i=u({},t,n);return{strokeWidth:t.borderWidth,stroke:i.borderColor,fill:i.color}},initCommonAreaSettings:function(n){var i=this._theme.area,t=u({},i,n);return this._commonAreaSettings={common:{strokeWidth:i.borderWidth,stroke:t.borderColor,fill:t.color},normal:{"class":null,strokeWidth:null,stroke:null,fill:null},hovered:{"class":t.hoveredClass,strokeWidth:i.hoveredBorderWidth,stroke:t.hoveredBorderColor,fill:t.hoveredColor},selected:{"class":t.selectedClass,strokeWidth:i.selectedBorderWidth,stroke:t.selectedBorderColor,fill:t.selectedColor}},this._palette=new wu(t.palette,t.paletteSize),this},getCommonAreaSettings:function(){return this._commonAreaSettings},getAreaSettings:function(n){n=n||{},n.color===i&&n.paletteIndex>=0&&(n.color=this._palette.getColor(n.paletteIndex)||i);var t=this._commonAreaSettings;return{normal:d(t.normal,n,cu),hovered:d(t.hovered,n,lu),selected:d(t.selected,n,au)}},initCommonMarkerSettings:function(n){var i=this._theme.marker,t=u({},i,n);return this._commonMarkerSettings={size:t.size,extraSize:t.extraSize,common:{strokeWidth:i.borderWidth,stroke:t.borderColor,fill:t.color},text:{strokeWidth:0,stroke:"none",fill:"none",font:u({},i.font,t.font)},normal:{"class":null,stroke:null,fill:null},hovered:{"class":t.hoveredClass,stroke:t.hoveredBorderColor,fill:t.hoveredColor},selected:{"class":t.selectedClass,stroke:t.selectedBorderColor,fill:t.selectedColor},extra:{strokeWidth:0,stroke:"none",fill:i.extraColor,opacity:i.extraOpacity}},this},getCommonMarkerSettings:function(){return this._commonMarkerSettings},getMarkerSettings:function(n){n=n||{};var t=this._commonMarkerSettings;return{size:n.size!==i?n.size:t.size,extraSize:n.extraSize!==i?n.extraSize:t.extraSize,normal:d(t.normal,n,vu),hovered:d(t.hovered,n,yu),selected:d(t.selected,n,pu),extra:t.extra}},getControlBarSettings:function(n){var t=this._theme.controlBar,i=u({},t,n);return u({},n,{shape:{strokeWidth:t.borderWidth,stroke:i.borderColor,fill:i.color}})},getTooltipSettings:function(n){var t=this._theme.tooltip,i=u({},t,n);return u({},n,{shape:{strokeWidth:t.borderWidth,stroke:i.borderColor,fill:i.color},text:{strokeWidth:0,stroke:"none",fill:"none",font:u({},t.font,i.font)}})},getLegendSettings:function(n){var i=this._theme.legend,t=u({},i,n);return u({},n,{background:{strokeWidth:i.borderWidth,stroke:t.borderColor,fill:t.color,opacity:i.opacity},text:{strokeWidth:0,stroke:"none",fill:"none",align:"left",font:u({},i.font,t.font),"class":"dxm-legend-text"},metrics:{horizontalIndent:i.horizontalIndent,verticalIndent:i.verticalIndent,horizontalPadding:t.horizontalPadding,verticalPadding:t.verticalPadding,textIndent:t.textIndent,itemSize:t.itemSize,itemSpacing:t.itemSpacing,maxWidth:t.maxWidth,maxHeight:t.maxHeight}})},getLegendItemSettings:function(n){var t=n.color;return t===i&&n.paletteIndex>=0&&(t=this._palette.getColor(n.paletteIndex)),{strokeWidth:0,stroke:"none",fill:t}}}),cu={color:"fill",borderColor:"stroke"},lu={hoveredColor:"fill",hoveredBorderColor:"stroke",hoveredClass:"class"},au={selectedColor:"fill",selectedBorderColor:"stroke",selectedClass:"class"},vu={color:"fill",borderColor:"stroke"},yu={hoveredColor:"fill",hoveredBorderColor:"stroke",hoveredClass:"class"},pu={selectedColor:"fill",selectedBorderColor:"stroke",selectedClass:"class"};kt={"default":{start:"#5f8b95",end:"#ba4d51"},"soft pastel":{start:"#92c7e2",end:"#f2ca84"},"harmony light":{start:"#a6c567",end:"#fcb65e"},pastel:{start:"#bb7862",end:"#a4d5c2"},bright:{start:"#e97f02",end:"#f8ca00"},soft:{start:"#9ab57e",end:"#e8c267"},ocean:{start:"#00a7c6",end:"#378a8a"},vintage:{start:"#f2c0b5",end:"#a85c4c"},violet:{start:"#d1a1d1",end:"#7b5685"}},n.viz.map.Map.include({_themeManagerType:hu});var ku=Math.PI*2,du=Math.PI/2,gu=Math.PI/4,ct=Math.PI/180,nf=1,bi=-180,ki=180,dt=-90,gt=90,tf=n.Class.inherit({setBounds:function(n){n=n||{};var t=this;return t._minlon=n.minLon>=bi?e(n.minLon):bi,t._maxlon=n.maxLon<=ki?e(n.maxLon):ki,t._minlat=n.minLat>=dt?e(n.minLat):dt,t._maxlat=n.maxLat<=gt?e(n.maxLat):gt,t},setSize:function(n,t){var i=this;return i._width=n,i._height=t,i._setupBounds(),i._adjustZoom(),i._adjustCenter(),i},_setupBounds:function(){var n=this,e=n._width,o=n._height,u=o/e;if(u=u<=nf?o:e,n._radius=u/ku,n._x0=e/2,n._y0=o/2,n._miny=n._y0-u/2,n._maxy=n._y0+u/2,!(n._maxlon-n._minlon>=360)||!(n._maxlat-n._minlat>=180)){var f=n._project(n._minlon,n._maxlat),s=n._project(n._maxlon,n._minlat),t=e/(s.x-f.x),r=o/(s.y-f.y),i=t;t<r?(i=t,t=(f.y+s.y)/2,r=o/i/2,f.y=t-r,s.y=t+r):t>r&&(i=r,r=(f.x+s.x)/2,t=e/i/2,f.x=r-t,s.x=r+t),n._x0=-f.x*i+e*i/2,n._y0=-f.y*i+o*i/2,n._radius*=i,u*=i,n._miny=n._y0-u/2,n._maxy=n._y0+u/2}},_project:function(n,t,i){var r=this,e=n*ct,f,o=r._radius*e+r._x0,u;return t<=dt?u=r._maxy:t>=gt?u=r._miny:(f=t*ct,u=r._radius*-si(er(gu+f/2))+r._y0),i||(u<=r._miny&&(u=r._miny),u>=r._maxy&&(u=r._maxy)),{x:o,y:u}},_invproject:function(n,t){var i=this,r=(n-i._x0)/i._radius,u=2*or(fr((i._y0-t)/i._radius))-du;return{lat:u/ct,lon:r/ct}},parseAreaData:function(n){for(var s=this,r=0,h=ot(n)?n.length:0,t,i,u,c,l,f,e,o=[];r<h;++r)if(t=n[r],i=0,u=ot(t)?t.length:0,u){for(f=[];i<u;)e=s._project(t[i++],t[i++]),f.push(e.x,e.y);o.push(f)}return o},parsePointData:function(n){return this._project(n[0],n[1])},projectArea:function(n){for(var r=0,s=n.length,i,t,f,e=[],u,o=this._zoom,h=this._xzoom,c=this._yzoom;r<s;++r){for(i=n[r],u=[],t=0,f=i.length;t<f;t+=2)u.push(o*i[t]-h,o*i[t+1]-c);e.push(w(u))}return e.join(" ")},projectPoint:function(n){return{x:p(this._zoom*n.x-this._xzoom),y:p(this._zoom*n.y-this._yzoom)}},_adjustZoom:function(){var n=this;n._xzoom=n._width*(n._zoom-1)/2,n._yzoom=n._height*(n._zoom-1)/2},_adjustCenter:function(){var n=this,t=n._project(n._loncenter,n._latcenter,!0);n._dxcenter=(n._x0-(n._xcenter=t.x))*n._zoom,n._dycenter=(n._y0-(n._ycenter=t.y))*n._zoom},getZoom:function(){return this._zoom},setZoom:function(n){var i=this,t=e(n);return t<wt&&(t=wt),t>bt&&(t=bt),i._zoom=wt<=t&&t<=bt?t:1,i._adjustZoom(),i._adjustCenter(),i},setCenter:function(n){return n=n||{},this._latcenter=e(n.lat)||0,this._loncenter=e(n.lon)||0,this._adjustCenter(),this},moveCenter:function(n,t){var i=this,r=i._xcenter+n/i._zoom,u=i._ycenter+t/i._zoom,f=i._invproject(r,u);return i.setCenter(f)},getTransform:function(){return{translateX:this._dxcenter,translateY:this._dycenter}}});n.viz.map.Map.include({_projectionType:tf});var ni=t(window.document),di=t.now,y=n.ui.events.addNamespace,h="dxVectorMap",r={},g,tt,it,v;rf();var uf="start",ff="move",ef="end",of="wheel",sf="hover-on",gi="hover-off",hf="click",cf="tooltip-check",lf="tooltip-show",af="tooltip-hide",vf="tooltip-move",yf=n.Class.inherit({ctor:function(){var n=this;n._groups={},n._createCallbacks(),n._resetState()},dispose:function(){var n=this;return n._dispose(),n._groups=n._context=n._callbacks=null,n},_resetState:function(){var n=this;c(n._tooltip_showTimeout),c(n._tooltip_hideTimeout),n._moving=n._click_time=n._hover_event=n._tooltip_target=n._tooltip_showTimeout=n._tooltip_hideTimeout=null},_createCallbacks:function(){var n=this;n._rootEvents={},n._rootEvents[r.start]=function(t){var i=v(t);(!i||n._touchEnabled)&&(t.preventDefault(),n._processStart(t),i&&n._processTooltipRootTouchStart(t))},n._documentEventsMoveEnd={},n._documentEventsMoveEnd[r.move]=function(t){n._processMove(t)},n._documentEventsMoveEnd[r.end]=function(t){n._processEnd(t)},n._rootEvents[r.wheel]=function(t){n._wheelEnabled&&(t.preventDefault(),n._processWheel(t))},n._groupEvents={},n._groupEvents[r.start]=function(t){var i=v(t);(!i||n._touchEnabled)&&(n._processClickStart(t),i&&n._processTooltipTouchStart(t))},n._groupClickEventsEnd={},n._groupClickEventsEnd[r.end]=function(t){n._processClickEnd(t)},n._groupEvents[r.over]=function(t){v(t)||(n._processHoverOn(t),n._processTooltipMouseOver(t))},n._groupEvents[r.out]=function(t){v(t)||(n._processHoverOff(t),n._processTooltipMouseOut(t))},n._groupTooltipEventsMouseMove={},n._groupTooltipEventsMouseMove[r.move]=function(t){n._processTooltipMouseMove(t)},n._groupTooltipEventsTouchMoveEnd={},n._groupTooltipEventsTouchMoveEnd[r.move]=function(t){n._processTooltipTouchMove(t)},n._groupTooltipEventsTouchMoveEnd[r.end]=function(t){n._processTooltipTouchEnd(t)},n._showTooltipCallback=function(){n._showTooltipCore()},n._hideTooltipCallback=function(){n._hideTooltipCore()},n._dispose=function(){var n=this;n=n._dispose=n._rootEvents=n._documentEventsMoveEnd=n._groupEvents=n._groupClickEventsEnd=n._groupTooltipEventsMouseMove=n._groupTooltipEventsTouchMoveEnd=n._showTooltipCallback=n._hideTooltipCallback=null}},_processStart:function(n){var i=this,r=rt(n);i._start_x=i._x=r.x,i._start_y=i._y=r.y,i._callbacks[uf].call(i._context,{$target:t(n.target),x:i._x,y:i._y});ni.off(i._documentEventsMoveEnd).on(i._documentEventsMoveEnd,n.data)},_processMove:function(n){var i=this,r=rt(n);(i._moving||et(i._start_x-r.x)>3||et(i._start_y-r.y)>3)&&(i._moving=!0,i._x=r.x,i._y=r.y,i._callbacks[ff].call(i._context,{$target:t(n.target),x:i._x,y:i._y}))},_processEnd:function(n){var i=this;ni.off(i._documentEventsMoveEnd),i._callbacks[ef].call(i._context,{$target:t(n.target),x:i._x,y:i._y}),i._moving=i._start_x=i._start_y=i._x=i._y=null},_processWheel:function(n){var i=n.originalEvent.wheelDelta/120||n.originalEvent.detail/-3||0;this._callbacks[of].call(this._context,{$target:t(n.target),delta:i})},_processHoverOn:function(n){var i=this;i._hover_event&&i._hover_event.target===n.target||(i._hover_event&&i._callbacks[gi].call(i._context,{$target:t(i._hover_event.target),category:i._hover_event.data.category}),i._hover_event=n,i._callbacks[sf].call(i._context,{$target:t(i._hover_event.target),category:i._hover_event.data.category}))},_processHoverOff:function(n){var r=this;a(t(n.target))!==i&&(r._hover_event&&r._callbacks[gi].call(r._context,{$target:t(r._hover_event.target),category:r._hover_event.data.category}),r._hover_event=null)},_processClickStart:function(n){this._click_time=di();n.data.container.off(this._groupClickEventsEnd).on(this._groupClickEventsEnd,n.data)},_processClickEnd:function(n){var i=this;i._click_time&&!i._moving&&di()-i._click_time<=500&&i._callbacks[hf].call(i._context,{$target:t(n.target),category:n.data.category}),i._click_time=null,n.data.container.off(i._groupClickEventsEnd)},_processTooltipMouseOver:function(n){var t=this,i;if(t._tooltipEnabled&&t._isTooltipAvailable(n)){i=rt(n),t._tooltip_x=i.x,t._tooltip_y=i.y;n.data.container.off(t._groupTooltipEventsMouseMove).on(t._groupTooltipEventsMouseMove,n.data);t._showTooltip(n,t._tooltip_target?null:yi)}},_processTooltipMouseMove:function(n){var t=this,i;t._isTooltipAvailable(n)?t._tooltip_target?t._showTooltip(n):(i=rt(n),(et(t._tooltip_x-i.x)>3||et(t._tooltip_y-i.y)>3)&&t._showTooltip(n,yi)):(n.data.container.off(t._groupTooltipEventsMouseMove),t._hideTooltip(pi))},_processTooltipMouseOut:function(n){this._tooltipEnabled&&(n.data.container.off(this._groupTooltipEventsMouseMove),this._hideTooltip(pi))},_processTooltipTouchStart:function(n){var t=this;if(t._tooltipEnabled&&t._isTooltipAvailable(n)){t._showTooltip(n,pr);n.data.container.off(t._groupTooltipEventsTouchMoveEnd).on(t._groupTooltipEventsTouchMoveEnd,n.data);t._skipTouchStart=!0}},_processTooltipRootTouchStart:function(){this._skipTouchStart||this._hideTooltip(wi),this._skipTouchStart=null},_processTooltipTouchMove:function(n){this._moving&&(this._hideTooltip(),n.data.container.off(this._groupTooltipEventsTouchMoveEnd))},_processTooltipTouchEnd:function(n){this._tooltip_showTimeout&&this._hideTooltip(wi),n.data.container.off(this._groupTooltipEventsTouchMoveEnd)},_isTooltipAvailable:function(n){var i=this,r=!i._moving;return r&&(!i._tooltip_event||i._tooltip_event.target!==n.target)&&(r=i._callbacks[cf].call(i._context,{$target:t(n.target),category:n.data.category})),r},_showTooltip:function(n,t){var i=this;c(i._tooltip_hideTimeout),i._tooltip_hideTimeout=null,c(i._tooltip_showTimeout),i._tooltip_event=n,t>0?i._tooltip_showTimeout=ft(i._showTooltipCallback,t):i._showTooltipCallback()},_hideTooltip:function(n){var t=this;c(t._tooltip_showTimeout),t._tooltip_showTimeout=null,n>0?t._tooltip_hideTimeout=t._tooltip_hideTimeout||ft(t._hideTooltipCallback,n):(c(t._tooltip_hideTimeout),t._hideTooltipCallback())},_showTooltipCore:function(){var n=this,i=n._tooltip_event,r=rt(i);n._tooltip_target||n._callbacks[lf].call(n._context,{$target:t(i.target),category:i.data.category}),n._tooltip_target=i.target,n._callbacks[vf].call(n._context,{$target:t(n._tooltip_target),category:i.data.category,x:r.x,y:r.y}),n._tooltip_showTimeout=null},_hideTooltipCore:function(){var n=this,i=n._tooltip_event;n._tooltip_target&&n._callbacks[af].call(n._context,{$target:t(n._tooltip_target),category:i.data.category}),n._tooltip_target=n._tooltip_hideTimeout=n._tooltip_event=null},attachRoot:function(n){return this._root=n,this},detachRoot:function(){return this._root=null,this},attachGroup:function(n,t){return this._groups[n]=t,this},detachGroup:function(n){return this._groups[n]=null,this},setCallbacks:function(n,t){return this._context=n,this._callbacks=t,this},setOptions:function(n){n=n||{};var t=this;return t._enabled=n.enabled,t._touchEnabled=n.touchEnabled,t._wheelEnabled=n.wheelEnabled,t._tooltipEnabled=n.tooltipEnabled,t},render:function(){var n=this,i,t;if(!n._enabled)return n;if(n._touchEnabled){if(g==="pointer"||g==="MSPointer")n._root.on(y("MSHoldVisual",h),function(n){n.preventDefault()});n._root.applySettings({style:tt})}n._root.on(n._rootEvents,{container:n._root});for(i in n._groups)t=n._groups[i],t&&t.on(n._groupEvents,{category:i,container:t});return n},clean:function(){var n=this,i,t;if(!n._enabled)return n;n._touchEnabled&&n._root.applySettings({style:it}),n._root.off("."+h),ni.off(n._documentEventsMoveEnd);for(i in n._groups)t=n._groups[i],t&&t.off("."+h);return n._resetState(),n}});n.viz.map.Map.include({_trackerType:yf}),s={},s[li]=ii,s[lt]=s[at]=s[vt]=s[yt]=ri,s[pt]=s[ai]=ui,s[vi]=fi,nr=n.Class.inherit({ctor:function(n){var t=this;t._container=n.container,t._createElements(n.renderer);var i=n.context,r=n.resetCallback,u=n.moveCallback,f=n.zoomCallback;t._reset=function(){r.call(i)},t._move=function(n,t){u.call(i,n,t)},t._zoom=function(n){f.call(i,n)},t._dispose=function(){delete this._reset,delete this._move,delete this._zoom,delete this._dispose,i=r=u=f=null},n=null},_createElements:function(n){var t=this._root=n.createGroup({"class":"dxm-control-bar"}),i=n.createGroup({"class":"dxm-control-buttons"}).append(t),u=n.createGroup({stroke:"none",strokeWidth:0,fill:"#000000",opacity:.0001,cursor:"pointer"}).append(t),r={bigCircleSize:58,smallCircleSize:28,buttonSize:10,arrowButtonOffset:20,incdecButtonSize:11,incButtonOffset:66,decButtonOffset:227,sliderLineStartOffset:88.5,sliderLineEndOffset:205.5,sliderLength:20,sliderWidth:8,trackerGap:4};this._buttonsGroup=i,this._createButtons(n,i,r),this._createTrackers(n,u,r),t.applySettings({translateX:50.5,translateY:50.5})},_createButtons:function(n,t,i){var r=i.buttonSize/2,u=i.arrowButtonOffset-r,e=i.arrowButtonOffset,f=i.incdecButtonSize/2;n.createCircle(0,0,i.bigCircleSize/2).append(t),n.createCircle(0,0,r).append(t),n.createPath([-r,-u,0,-e,r,-u]).append(t),n.createPath([u,-r,e,0,u,r]).append(t),n.createPath([r,u,0,e,-r,u]).append(t),n.createPath([-u,r,-e,0,-u,-r]).append(t),n.createCircle(0,i.incButtonOffset,i.smallCircleSize/2).append(t),n.createSimplePath({d:w([-f,i.incButtonOffset,f,i.incButtonOffset])+" "+w([0,i.incButtonOffset-f,0,i.incButtonOffset+f])}).append(t),n.createCircle(0,i.decButtonOffset,i.smallCircleSize/2).append(t),n.createSimplePath({d:w([-f,i.decButtonOffset,f,i.decButtonOffset])}).append(t),n.createSimplePath({d:w([0,i.sliderLineStartOffset,0,i.sliderLineEndOffset])}).append(t),this._zoomDrag=n.createRect(-i.sliderLength/2,i.sliderLineEndOffset-i.sliderWidth/2,i.sliderLength,i.sliderWidth).append(t),this._zoomCoeff=(i.sliderLineEndOffset-i.sliderLineStartOffset)/5},_createTrackers:function(n,t,i){var u=p((i.arrowButtonOffset-i.trackerGap)/2),o=i.arrowButtonOffset-u,s=p(oi(i.bigCircleSize*i.bigCircleSize/4-u*u,.5)),e=s-o,r;r=n.createRect(-u,-u,u*2,u*2).append(t),f(r.$element,li),r=n.createRect(-u,-s,u*2,e).append(t),f(r.$element,lt),r=n.createRect(o,-u,e,u*2).append(t),f(r.$element,at),r=n.createRect(-u,o,u*2,e).append(t),f(r.$element,vt),r=n.createRect(-s,-u,e,u*2).append(t),f(r.$element,yt),r=n.createCircle(0,i.incButtonOffset,i.smallCircleSize/2).append(t),f(r.$element,pt),r=n.createCircle(0,i.decButtonOffset,i.smallCircleSize/2).append(t),f(r.$element,ai),r=this._zoomDragCover=n.createRect(-i.sliderLength/2,i.sliderLineEndOffset-i.sliderWidth/2,i.sliderLength,i.sliderWidth).append(t),f(r.$element,vi)},dispose:function(){var n=this;return delete n._container,n._dispose(),n._root.clear(),delete n._root,delete n._buttonsGroup,delete n._zoomDrag,delete n._zoomDragCover,n},setZoom:function(n){return this._adjustZoom(si(n)/ar),this},setOptions:function(n){return n=n||{},this._enabled=n.enabled!==i?!!n.enabled:!0,this._buttonsGroup.applySettings(n.shape),this},clean:function(){return this._enabled&&this._root.detach(),this},render:function(){return this._enabled&&this._root.append(this._container),this},_adjustZoom:function(n){var t=n,i;t<=5||(t=5),t>=0||(t=0),this._zoomFactor=t,i=-t*this._zoomCoeff,this._zoomDrag.applySettings({translateY:i}),this._zoomDragCover.applySettings({translateY:i})},_applyZoom:function(){this._zoom(oi(2,this._zoomFactor))},processStart:function(n){var t=s[n.data]||ti;return this._command=new t(this,n),this},processMove:function(n){return this._command.update(n),this},processEnd:function(n){return this._command.finish(n),this},processWheel:function(n){return this._adjustZoom(this._zoomFactor+n.delta*.5),this._applyZoom(),this}}),ti.prototype.update=function(n){var t=this;t._owner._move(t._x-n.x,t._y-n.y),t._x=n.x,t._y=n.y},ti.prototype.finish=function(){nt(this)},ii.prototype.update=function(n){n.data!==this._command&&nt(this)},ii.prototype.finish=function(){this._owner._reset(),this._owner._adjustZoom(0),nt(this)},ri.prototype.update=function(n){this._command!==n.data&&this.finish()},ri.prototype.finish=function(){nt(this._stop())},ui.prototype.update=function(n){this._command!==n.data&&this.finish()},ui.prototype.finish=function(){this._owner._applyZoom(),nt(this._stop())},fi.prototype.update=function(n){this._owner._adjustZoom(this._owner._zoomFactor+(this._pos-n.y)/this._owner._zoomCoeff),this._pos=n.y},fi.prototype.finish=function(){this._owner._applyZoom(),nt(this)},n.viz.map.Map.include({_controlBarType:nr}),tr=n.Class.inherit({ctor:function(t){var i=this;i._container=t.container,i._root=t.renderer.createGroup({"class":"dxm-tooltip"}),i._renderer=t.renderer,i._inner=new n.viz.charts.Tooltip({renderer:t.renderer,arrowLength:10,paddingLeftRight:12,paddingTopBottom:10},i._root),i._inner.draw(),i._inner.text.applySettings({"class":"dxm-tooltip-text"}),i._enabled=!1},dispose:function(){var n=this;return n._inner.dispose(),delete n._inner,delete n._container,n._root.clear(),delete n._root,n},enabled:function(){return this._enabled},setSize:function(n,t){return this._inner.update({canvasWidth:n,canvasHeight:t}),this},setOptions:function(n){var t=this;return n=n||{},t._enabled=!!n.enabled,t._inner.update({color:n.color||null}),t._inner.cloud.applySettings(n.shape),t._inner.text.applySettings(n.text),t._customizeText=l(n.customizeText)?n.customizeText:null,t},clean:function(){return this._root.detach(),this._inner.hide(),this},render:function(){return this._root.append(this._container),this},check:function(n){if(this._enabled){var t=this._customizeText?this._customizeText.call(n,n):null;return!!(this._text=t!==null&&t!==i?ut(t):"")}return!1},show:function(){return this._inner.show(),this},hide:function(){return this._inner.hide(),this},move:function(n){return this._inner.move(n.x,n.y,12,this._text),this}}),n.viz.map.Map.include({_tooltipType:tr}),ir=n.Class.inherit({ctor:function(n){var t=this;t._container=n.container,t._renderer=n.renderer,t._themeManager=n.themeManager,t._root=t._renderer.createGroup({"class":"dxm-legend"}),t._background=t._renderer.createRect(0,0,0,0,0,{"class":"dxm-legend-background"}).append(t._root),t._itemsGroup=t._renderer.createGroup().append(t._root),t._clip=t._renderer.createClipRect().append(),t._itemsGroup.applySettings({clipId:t._clip.id})},dispose:function(){var n=this;return n._root.clear(),n._clip.dispose(),n._root=n._background=n._itemsGroup=n._clip=n._container=n._renderer=null,n},setSize:function(n,t){var i=this;return i._containerWidth=n,i._containerHeight=t,i._hasItems&&i._adjustLocation(),i},setOptions:function(n){n=n||{};var t=this;return t._items=n.items&&n.items.length>0?n.items:[],t._enabled=(n.enabled!==i?!!n.enabled:!0)&&t._items.length>0,t._metrics=n.metrics,t._backgroundSettings=n.background,t._textSettings=n.text,t},_createItems:function(){for(var n=this,i=n._metrics,l=n._renderer,p=n._themeManager,w=n._textSettings,f=n._itemsGroup,e=n._items,a=e.length,k,o=[],u,v=i.horizontalPadding,s=i.verticalPadding,r=i.itemSize,y=i.itemSpacing,b=i.textIndent,h,c,t=0;t<a;++t)o.push(l.createText(e[t].text,0,0,w).append(f));for(t=0;t<a;++t)u=o[t].getBBox(),h=ur(r,u.height),c=s+h/2,l.createRect(v,c-r/2,r,r,0,p.getLegendItemSettings(e[t])).append(f),o[t].applySettings({x:v+r+b,y:c-u.y-u.height/2}),s+=h+y;n._totalWidth=ei(n._metrics.maxWidth,f.getBBox().width+2*i.horizontalPadding),n._totalHeight=ei(n._metrics.maxHeight,s+i.verticalPadding-y),n._background.applySettings({x:0,y:0,width:n._totalWidth,height:n._totalHeight}),n._clip.updateRectangle({x:0,y:0,width:n._totalWidth,height:n._totalHeight}),n._adjustLocation(),n._hasItems=!0},_adjustLocation:function(){var n=this;n._root.applySettings({translateX:n._containerWidth-n._totalWidth-n._metrics.horizontalIndent,translateY:n._containerHeight-n._totalHeight-n._metrics.verticalIndent})},clean:function(){var n=this;return n._enabled&&(n._root.detach(),n._itemsGroup.clear(),n._hasItems=null),n},render:function(){var n=this;return n._enabled&&(n._background.applySettings(n._backgroundSettings),n._root.append(n._container),n._createItems()),n}}),n.viz.map.Map.include({_legendType:ir}),n.ui.registerComponent("dxVectorMap",n.viz.map.Map),n.viz.map.sources={}})(DevExpress,jQuery),DevExpress.MOD_VIZ_VECTORMAP=!0}